import{u as N,a as y,r as l,j as e,L as v}from"./index-C-bofkHd.js";import{u as w,S as E}from"./index.esm-oaNbjKZd.js";import{a as S,u as P,c as I}from"./pets-yUH3lGM-.js";import{a as k,A as L}from"./tutores-Cr8ILfQa.js";import{L as p}from"./loader-circle-BwTFM76g.js";function R(){const{id:t}=N(),d=y(),[n,c]=l.useState(!1),[b,m]=l.useState(!1),[f,u]=l.useState([]),[x,i]=l.useState(null),{register:o,handleSubmit:h,reset:g,formState:{errors:a}}=w();l.useEffect(()=>{k(1,100).then(s=>{const r=s.data;Array.isArray(r)?u(r):r&&"content"in r&&u(r.content)}).catch(s=>console.error("Erro ao carregar tutores:",s)),t&&(m(!0),S(Number(t)).then(s=>{g(s.data)}).catch(s=>{i(s.message||"Erro ao carregar dados do pet.")}).finally(()=>m(!1)))},[t,g]);const j=async s=>{c(!0),i(null);try{const r={...s,idade:Number(s.idade),tutorId:s.tutorId?Number(s.tutorId):void 0};t?await P(Number(t),r):await I(r),d("/")}catch(r){i(r.message||"Erro ao salvar pet.")}finally{c(!1)}};return b?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(p,{className:"animate-spin mx-auto mb-2"})," Carregando dados..."]}):e.jsxs("div",{className:"p-4 max-w-2xl mx-auto",children:[e.jsxs(v,{to:"/",className:"inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6",children:[e.jsx(L,{size:20})," Voltar para a lista"]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:t?"Editar Pet":"Cadastrar Novo Pet"}),x&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:x}),e.jsxs("form",{onSubmit:h(j),className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nome do Pet *"}),e.jsx("input",{...o("nome",{required:"Nome é obrigatório"}),className:`w-full border rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 outline-none ${a.nome?"border-red-500":"border-gray-300"}`,placeholder:"Ex: Rex"}),a.nome&&e.jsx("p",{className:"text-red-500 text-xs",children:a.nome.message})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Espécie *"}),e.jsx("input",{...o("especie",{required:"Espécie é obrigatória"}),className:`w-full border rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 outline-none ${a.especie?"border-red-500":"border-gray-300"}`,placeholder:"Ex: Cachorro, Gato"}),a.especie&&e.jsx("p",{className:"text-red-500 text-xs",children:a.especie.message})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Idade (anos) *"}),e.jsx("input",{type:"number",...o("idade",{required:"Idade é obrigatória",min:{value:0,message:"Idade mínima é 0"}}),className:`w-full border rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 outline-none ${a.idade?"border-red-500":"border-gray-300"}`}),a.idade&&e.jsx("p",{className:"text-red-500 text-xs",children:a.idade.message})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tutor"}),e.jsxs("select",{...o("tutorId"),className:"w-full border border-gray-300 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 outline-none bg-white",children:[e.jsx("option",{value:"",children:"Selecione um tutor (opcional)"}),f.map(s=>e.jsx("option",{value:s.id,children:s.nome},s.id))]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"URL da Foto"}),e.jsx("input",{...o("foto"),className:"w-full border border-gray-300 rounded-lg p-2.5 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"https://exemplo.com/foto.jpg"})]}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[e.jsxs("button",{type:"submit",disabled:n,className:"flex-1 bg-blue-600 text-white font-semibold py-2.5 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:[n?e.jsx(p,{className:"animate-spin",size:20}):e.jsx(E,{size:20}),t?"Atualizar Pet":"Salvar Pet"]}),e.jsx("button",{type:"button",onClick:()=>d("/"),className:"px-6 py-2.5 border border-gray-300 text-gray-700 font-semibold rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})]})}export{R as default};
